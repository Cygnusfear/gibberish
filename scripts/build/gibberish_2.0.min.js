function AudioFileRequest(e,t){this.url=e,(t===void 0||null==t)&&(t=!0),this.async=t;var i=e.split(".");this.extension=i[i.length-1].toLowerCase()}function Decoder(){}function WAVDecoder(){}function AIFFDecoder(){}function createInput(){navigator.webkitGetUserMedia({audio:!0},function(e){console.log("CONNECTING INPUT"),Gibberish.mediaStreamSource=Gibberish.context.createMediaStreamSource(e),Gibberish.mediaStreamSource.connect(Gibberish.node),_hasInput=!0})}Gibberish={memo:{},functions:{},upvalues:[],codeblock:[],analysisCodeblock:[],analysisUgens:[],dirtied:[],id:0,isDirty:!1,out:null,debug:!1,callback:"",audioFiles:{},sequencers:[],createCallback:function(){this.memo={},this.codeblock.length=0;for(var i=0;this.dirtied.length>i;i++)this.dirtied[i].codegen();if(this.dirtied.length=0,this.codestring=this.upvalues.join(""),this.codestring+="\nGibberish.callback = function(input) {\n	",this.memo={},this.out.getCodeblock(),this.codestring+=this.codeblock.join("	"),this.codestring+="\n	",this.codeblock.length=0,this.analysisUgens.length>0){this.analysisCodeblock.length=0;for(var i=0;this.analysisUgens.length>i;i++)this.codeblock.length=0,this.analysisUgens[i].codegen2(),this.codestring+=this.codeblock.join(""),this.codestring+="\n	",this.analysisCodeblock.push(this.analysisUgens[i].analysisCodegen());this.codestring+=this.analysisCodeblock.join("\n	"),this.codestring+="\n	"}this.codestring+="return "+this.out.variable+";\n",this.codestring+="}",this.callbackString=this.codestring,this.debug&&console.log(this.callbackString),eval(this.codestring)},audioProcess:function(e){for(var t=e.outputBuffer.getChannelData(0),i=e.outputBuffer.getChannelData(1),r=e.inputBuffer.getChannelData(0),n=Gibberish,s=n.sequencers,a=0,o=e.outputBuffer.length;o>a;a++){for(var h=0;s.length>h;h++)s[h].tick();n.isDirty&&(n.createCallback(),n.isDirty=!1);var b=n.callback(r[a]);t[a]=b[0],i[a]=b[1]}},audioProcessFirefox:function(e){for(var t=Gibberish,i=0,r=e.length;r>i;i+=2){for(var n=0;t.sequencers.length>n;n++)t.sequencers[n].tick();t.isDirty&&(t.createCallback(),t.isDirty=!1);var s=t.callback();e[i]=s[0],e[i+1]=s[1]}},clear:function(){this.upvalues.length=1,this.out.inputs.length=0,this.analysisUgens.length=0,this.sequencers.length=0,Gibberish.dirty(this.out)},dirty:function(e){if(e!==void 0){for(var t=!1,i=0;this.dirtied.length>i;i++)this.dirtied[i].variable===e.variable&&(t=!0);t||(this.isDirty=!0,this.dirtied.push(e))}else this.isDirty=!0},generateSymbol:function(e){return e+"_"+this.id++},AudioDataDestination:function(e,t){var i=new Audio;i.mozSetup(2,e);var r,n=0,s=e/2,a=null;setInterval(function(){var e;if(a){if(e=i.mozWriteAudio(a.subarray(r)),n+=e,r+=e,a.length>r)return;a=null}var o=i.mozCurrentSampleOffset(),h=o+s-n;if(h>0){var b=new Float32Array(h);t(b),e=i.mozWriteAudio(b),o=i.mozCurrentSampleOffset(),b.length>e&&(a=b,r=e),n+=e}},100)},init:function(){Gibberish.out=new Gibberish.Bus2,Gibberish.out.codegen(),Gibberish.out.getCodeblock(),Gibberish.dirty(Gibberish.out);var e=arguments[0]===void 0?1024:arguments[0];return start=function(){if(-1===navigator.userAgent.indexOf("Firefox")){if(document.getElementsByTagName("body")[0].removeEventListener("touchstart",start),Gibberish.context=new webkitAudioContext,Gibberish.node=Gibberish.context.createJavaScriptNode(e,2,2,Gibberish.context.sampleRate),Gibberish.node.onaudioprocess=Gibberish.audioProcess,Gibberish.node.connect(Gibberish.context.destination),"ontouchstart"in document.documentElement){var t=Gibberish.context.createBufferSource();t.connect(Gibberish.context.destination),t.noteOn(0)}}else"function"==typeof AudioContext?(Gibberish.context=new AudioContext,Gibberish.node=Gibberish.context.createScriptProcessor(e,2,2,Gibberish.context.sampleRate),Gibberish.node.onaudioprocess=Gibberish.audioProcess,Gibberish.node.connect(Gibberish.context.destination)):(Gibberish.AudioDataDestination(44100,Gibberish.audioProcessFirefox),Gibberish.context={sampleRate:44100})},"ontouchstart"in document.documentElement?document.getElementsByTagName("body")[0].addEventListener("touchstart",start):start(),this},makePanner:function(){var e=Math.sin,t=Math.cos,i=Math.sqrt(2)/2,r=function(r,n,s){var a="object"==typeof r,o=a?r[0]:r,h=a?r[1]:r;return s[0]=o*i*(t(n)-e(n)),s[1]=h*i*(t(n)+e(n)),s};return r},polyInit:function(e){e.mod=e.polyMod,e.removeMod=e.removePolyMod;for(var t in e.polyProperties)(function(t){var i=e.polyProperties[t];Object.defineProperty(e,t,{get:function(){return i},set:function(r){i=r;for(var n=0;e.children.length>n;n++)e.children[n][t]=i}})})(t)},interpolate:function(e,t){var i=0|t,r=i+1>e.length-1?0:i+1;return frac=t-i,e[i]+frac*(e[r]-e[i])},"export":function(e,t){for(var i in Gibberish[e])t[i]=Gibberish[e][i]},ugen:function(){Gibberish.extend(this,{processProperties:function(){if("object"!=typeof arguments[0][0]||arguments[0][0].type!==void 0||Array.isArray(arguments[0][0])||"op"===arguments[0][0].name){var e=0;for(var t in this.properties)"object"==typeof this.properties[t]&&this.properties[t].binops!==void 0?arguments[0][e]!==void 0&&(this.properties[t].value=arguments[0][e++]):arguments[0][e]!==void 0&&(this.properties[t]=arguments[0][e++])}else{var i=arguments[0][0];for(var t in i)i[t]!==void 0&&("object"==typeof this.properties[t]&&this.properties[t].binops!==void 0?this.properties[t].value=i[t]:this[t]=i[t])}return this},codegen:function(){var e="",t=null;if(Gibberish.memo[this.symbol])return Gibberish.memo[this.symbol];t=this.variable?this.variable:Gibberish.generateSymbol("v"),Gibberish.memo[this.symbol]=t,this.variable=t,e+="var "+t+" = "+this.symbol+"(";for(var i in this.properties){var r=this.properties[i],n="";if(Array.isArray(r.value)){0===r.value.length&&(n=0);for(var s=0;r.value.length>s;s++){var a=r.value[s];n+="object"==typeof a?null!==a?a.codegen():"null":"function"==typeof r.value?r.value():r.value,n+=r.value.length-1>s?", ":""}}else"object"==typeof r.value?n=null!==r.value?r.value.codegen():"null":"undefined"!==r.name&&(n="function"==typeof r.value?r.value():r.value);if(e+=n,r.binops)for(var o=0;r.binops.length>o;o++){var h,b=r.binops[o];h="number"==typeof b.ugen?b.ugen:null!==b.ugen?b.ugen.codegen():"null","="===b.binop?(e=e.replace(n,""),e+=h):"++"===b.binop?(Gibberish.upvalues.push("var abs = Math.abs\n;"),e+=" + abs("+h+")"):e+=" "+b.binop+" "+h}e+=", "}return" "===e.charAt(e.length-1)&&(e=e.slice(0,-2)),e+=");\n",null===this.codeblock&&Gibberish.upvalues.pushUnique("var "+this.symbol+" = Gibberish.functions."+this.symbol+";\n"),this.codeblock=e,this.dirty=!1,t},getCodeblock:function(){if(null!==this&&(null===this.codeblock&&this.codegen(),!Gibberish.memo[this.symbol])){if(Gibberish.memo[this.symbol]=this.variable,"analysis"!==this.type)for(var e in this.properties){var t=this.properties[e];if(Array.isArray(t.value))for(var i=t.value,r=0;i.length>r;r++){var n=i[r];"object"==typeof n&&null!==n&&n.getCodeblock()}else"object"==typeof t.value&&null!==t.value&&t.value.getCodeblock();if(t.binops)for(var s=0;t.binops.length>s;s++){var a=t.binops[s];"object"==typeof a.ugen&&null!==a.ugen&&a.ugen.getCodeblock()}}return"analysis"===this.type?Gibberish.codeblock.unshift(this.codeblock):""!==this.codeblock&&Gibberish.codeblock.push(this.codeblock),this.variable}},defineUgenProperty:function(e,t){this.properties[e]={symbol:Gibberish.generateSymbol("v"),value:t,binops:[],getCodeblock:function(){"number"!=typeof this.value&&Gibberish.codeblock.push("var "+this.symbol+" = "+this.value+";\n")},codegen:function(){return"number"==typeof this.value||"string"==typeof this.value?this.value:(this.value.codegen(),this.value.symbol)},parent:this,name:e},function(t){var i=e;Object.defineProperty(t,i,{configurable:!0,get:function(){return t.properties[i].value},set:function(e){t.properties[i].value=e,Gibberish.dirty(t)}})}(this)},init:function(){if(this.initalized||(this.symbol=Gibberish.generateSymbol(this.name),this.codeblock=null,this.variable=null),this.properties===void 0&&(this.properties={}),!this.initialized){this.destinations=[];for(var e in this.properties)this.defineUgenProperty(e,this.properties[e])}if(arguments.length>0&&"object"==typeof arguments[0][0]&&"undefined"===arguments[0][0].type){var t=arguments[0][0];for(var e in t)this[e]=t[e]}return Gibberish.functions[this.symbol]=this.callback,this.initialized=!0,this},mod:function(e,t,i){var r=this.properties[e],n={ugen:t,binop:i};r.binops.push(n),Gibberish.dirty(this)},removeMod:function(e,t){if(t===void 0)this.properties[e].binops.length=0;else if("number"==typeof t)this.properties[e].binops.splice(t,1);else if("object"==typeof t)for(var i=0,r=this.properties[e].binops.length;r>i;i++)this.properties[e].binops[i].ugen===t&&this.properties[e].binops.splice(i,1);Gibberish.dirty(this)},polyMod:function(e,t,i){for(var r=0;this.children.length>r;r++)this.children[r].mod(e,t,i);Gibberish.dirty(this)},removePolyMod:function(){var e=Array.prototype.slice.call(arguments,0);if("amp"!==arguments[0]&&"pan"!==arguments[0])for(var t=0;this.children.length>t;t++)this.children[t].removeMod.apply(this.children[t],e);else this.removeMod.apply(this,e);Gibberish.dirty(this)},smooth:function(e){var t=new Gibberish.OnePole;this.mod(e,t,"=")},connect:function(e){return e===void 0&&(e=Gibberish.out),-1===this.destinations.indexOf(e)&&(e.addConnection(this,1),this.destinations.push(e)),this},send:function(e,t){return-1===this.destinations.indexOf(e)?(e.addConnection(this,t),this.destinations.push(e)):e.adjustSendAmount(this,t),this},disconnect:function(e){if(e===void 0){for(var t=0;this.destinations.length>t;t++)this.destinations[t].removeConnection(this);this.destinations=[]}else{var i=this.destinations.indexOf(e);i>-1&&this.destinations.splice(i,1),e.removeConnection(this)}return this}})}},Array2=function(){this.length=0},Array2.prototype=[],Array2.prototype.remove=function(e,t){if(t=t===void 0?!0:t,e===void 0){for(var i=0;this.length>i;i++)delete this[i];this.length=0}else if("number"==typeof e)this.splice(e,1);else if("string"==typeof e){for(var r=[],i=0;this.length>i;i++){var n=this[i];if(n.type===e||n.name===e){if(!t)return this.splice(i,1),void 0;r.push(i)}}for(var i=0;r.length>i;i++)this.splice(r[i],1)}else if("object"==typeof e)for(var s=this.indexOf(e);s>-1;)this.splice(s,1),s=this.indexOf(e);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.get=function(e){if("number"==typeof e)return this[e];if("string"==typeof e)for(var t=0;this.length>t;t++){var i=this[t];if(i.name===e)return i}else if("object"==typeof e){var r=this.indexOf(e);if(r>-1)return this[r]}return null},Array2.prototype.replace=function(e,t){if(t.parent=this,t.input=e.input,"number"!=typeof e){var i=this.indexOf(e);i>-1&&this.splice(i,1,t)}else this.splice(e,1,t);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.insert=function(e,t){if(e.parent=this,this.input=this.parent,Array.isArray(e))for(var i=0;e.length>i;i++)this.splice(t+i,0,e[i]);else this.splice(t,0,e);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.add=function(){for(var e=0;arguments.length>e;e++)arguments[e].parent=this,arguments[e].input=this.parent,this.push(arguments[e]);this.parent&&(console.log("DIRTYING"),Gibberish.dirty(this.parent))},Array.prototype.pushUnique=function(){for(var e=0;arguments.length>e;e++){for(var t=arguments[e],i=!0,r=0;this.length>r;r++)if(t===this[r]){i=!1;break}i&&this.push(t)}};var rnd=Math.random;Gibberish.rndf=function(e,t,i,r){if(r=r===void 0?!0:r,i===void 0&&"object"!=typeof e){1==arguments.length?(e=0,t=arguments[0]):2==arguments.length?(e=arguments[0],t=arguments[1]):(e=0,t=1);var n=t-e,s=rnd(),a=n*s;return e+a}var o=[],h=[];i===void 0&&(i=t||e.length);for(var b=0;i>b;b++){var u;if("object"==typeof arguments[0])u=arguments[0][randomi(0,arguments[0].length-1)];else if(r)u=Gibberish.rndf(e,t);else{for(u=Gibberish.rndf(e,t);h.indexOf(u)>-1;)u=Gibberish.rndf(e,t);h.push(u)}o.push(u)}return o},Gibberish.Rndf=function(){var e,t,i=Math.random;return 0===arguments.length?(e=0,t=1):1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),function(){var r=e+i()*t;return r}},Gibberish.rndi=function(){var e,t;return 0===arguments.length?(e=0,t=1):1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),Math.round(e+Math.random()*t)},Gibberish.Rndi=function(){var e,t,i=Math.random,r=Math.round;return 0===arguments.length?(e=0,t=1):1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),function(){var n=r(e+i()*t);return n}},Gibberish.extend=function(e,t){for(var i in t)i.split("."),t[i]instanceof Array&&100>t[i].length?(e[i]=t[i].slice(0),"fx"===i&&(e[i].parent=t[i].parent)):"object"!=typeof t[i]||null===t[i]||t[i]instanceof Float32Array?e[i]=t[i]:(e[i]=e[i]||{},arguments.callee(e[i],t[i]));return e},Function.prototype.clone=function(){return eval("["+(""+this)+"]")[0]},String.prototype.format=function(e,t,i){function r(){var r=this,n=arguments.length+1;for(e=0;n>e;i=arguments[e++])t=i,r=r.replace(RegExp("\\{"+(e-1)+"\\}","g"),t);return r}return r.native=String.prototype.format,r}(),Gibberish.future=function(e,t){var i=new Gibberish.Sequencer({values:[function(){},function(){e(),i.stop()}],durations:[t]}).start()},Gibberish.Proxy=function(){var e=0;Gibberish.extend(this,{name:"proxy",type:"effect",properties:{},callback:function(){return e}}).init(),this.input=arguments[0],e=this.input.parent[this.input.name],delete this.input.parent[this.input.name],this.input.parent.properties[this.input.name].value=this,Object.defineProperty(this.input.parent,this.input.name,{get:function(){return e},set:function(t){e=t}}),Gibberish.dirty(this.input.parent)},Gibberish.Proxy.prototype=new Gibberish.ugen,Gibberish.oscillator=function(){this.type="oscillator",this.oscillatorInit=function(){return this.fx=new Array2,this.fx.parent=this,this}},Gibberish.oscillator.prototype=new Gibberish.ugen,Gibberish._oscillator=new Gibberish.oscillator,Gibberish.Wavetable=function(){var e=0,t=null,i=Gibberish.context.sampleRate/1024;this.properties={frequency:440,amp:.25},this.getTable=function(){return t},this.setTable=function(e){t=e},this.callback=function(r,n){var s,a,o,h,b;for(e+=r/i;e>=1024;)e-=1024;return s=0|e,a=e-s,s=1023&s,o=1023===s?0:s+1,h=t[s],b=t[o],(h+a*(b-h))*n}},Gibberish.Wavetable.prototype=Gibberish._oscillator,Gibberish.asmSine=function(e){"use asm";function t(e,t,s){return e=+e,t=+t,s=+s,n=+(n+ +(2*+(e/s)*r)),+(+i(n)*t)}var i=e.Math.sin,r=3.14159,n=0;return t},Gibberish.asmSine2=function(){return this.properties={frequency:440,amp:.5,sr:Gibberish.context.sampleRate},this.name="sine",this.callback=Gibberish.asmSine({Math:Math}),this.init(),this.oscillatorInit(),this},Gibberish.asmSine2.prototype=Gibberish._oscillator,Gibberish.Sine=function(){this.__proto__=new Gibberish.Wavetable,this.name="sine";for(var e=2*Math.PI,t=new Float32Array(1024),i=1024;i--;)t[i]=Math.sin(i/1024*e);this.setTable(t),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Sine2=function(){this.__proto__=new Gibberish.Sine,this.name="sine2",this.defineUgenProperty("pan",0);var e=this.__proto__.callback,t=Gibberish.makePanner(),i=[0,0];this.callback=function(r,n,s){var a=e(r,n);return i=t(a,s,i)},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Square=function(){this.__proto__=new Gibberish.Wavetable,this.name="square";for(var e=(2*Math.PI,new Float32Array(1024)),t=1024;t--;)e[t]=t/1024>.5?1:-1;this.setTable(e),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw=function(){this.__proto__=new Gibberish.Wavetable,this.name="saw";for(var e=new Float32Array(1024),t=1024;t--;)e[t]=4*((t/1024/2+.25)%.5-.25);this.setTable(e),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw2=function(){this.__proto__=new Gibberish.Saw,this.name="saw2",this.defineUgenProperty("pan",0);var e=this.__proto__.callback,t=Gibberish.makePanner(),i=[0,0];this.callback=function(r,n,s){var a=e(r,n);return i=t(a,s,i)},this.init()},Gibberish.Triangle=function(){this.__proto__=new Gibberish.Wavetable,this.name="triangle";for(var e=new Float32Array(1024),t=Math.abs,i=1024;i--;)e[i]=1-4*t((i/1024+.25)%1-.5);this.setTable(e),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Triangle2=function(){this.__proto__=new Gibberish.Triangle,this.name="triangle2",this.defineUgenProperty("pan",0);var e=this.__proto__.callback,t=Gibberish.makePanner(),i=[0,0];this.callback=function(r,n,s){var a=e(r,n);return t(a,s,i)},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw3=function(){var e=0,t=0,i=2.5,r=-1.5,n=0,s=Math.sin,a=11;pi_2=2*Math.PI,sr=Gibberish.context.sampleRate,Gibberish.extend(this,{name:"saw",properties:{frequency:440,amp:.15,sr:Gibberish.context.sampleRate},callback:function(o){var h=o/sr,b=.5-h,u=a*b*b*b*b,c=.376-.752*h,l=1-2*h,p=0;return t+=h,t-=t>1?2:0,e=.5*(e+s(pi_2*(t+e*u))),p=i*e+r*n,n=e,p+=c,p*l}}),Object.defineProperty(this,"scale",{get:function(){return a},set:function(e){a=e}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw3.prototype=Gibberish._oscillator,Gibberish.PWM=function(){var e=0,t=0,i=0,r=0,n=0,s=2.5,a=-1.5,o=Math.sin,h=11;pi_2=2*Math.PI,test=0,Gibberish.extend(this,{name:"pwm",properties:{frequency:440,amp:.15,pulsewidth:.5,sr:Gibberish.context.sampleRate},callback:function(b,u,c,l){var p=b/l,f=.5-p,d=h*f*f*f*f,m=1-2*p,y=0;return n+=p,n-=n>1?2:0,e=.5*(e+o(pi_2*(n+e*d))),t=.5*(t+o(pi_2*(n+t*d+c))),y=t-e,y=s*y+a*(i-r),i=e,r=t,y*m*u}}),Object.defineProperty(this,"scale",{get:function(){return h},set:function(e){h=e}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.PWM.prototype=Gibberish._oscillator,Gibberish.Noise=function(){var e=Math.random;Gibberish.extend(this,{name:"noise",properties:{amp:1},callback:function(t){return(2*e()-1)*t}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Noise.prototype=Gibberish._oscillator,Gibberish.KarplusStrong=function(){var e=[0],t=0,i=Math.random,r=Gibberish.makePanner(),n=Gibberish.context.sampleRate,s=[0,0];Gibberish.extend(this,{name:"karplus_strong",properties:{blend:1,damping:0,amp:1,channels:2,pan:0},note:function(t){var r=Math.floor(n/t);e.length=0;for(var s=0;r>s;s++)e[s]=2*i()-1},callback:function(n,a,o,h,b){var u=e.shift(),c=i()>n?-1:1;a=a>0?a:0;var l=c*(u+t)*(.5-a/100);return t=l,e.push(l),l*=o,1===h?l:r(l,b,s)}}).init().oscillatorInit().processProperties(arguments)},Gibberish.KarplusStrong.prototype=Gibberish._oscillator,Gibberish.PolyKarplusStrong=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"poly_karplus_strong",maxVoices:5,voiceCount:0,polyProperties:{blend:1,damping:0},note:function(e,t){var i=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),i.note(e,t)}}),this.amp=1/this.maxVoices,this.processProperties(arguments),this.children=[],this.dirty=!0;for(var e=0;this.maxVoices>e;e++){var t={blend:this.blend,damping:this.damping,channels:2,amp:1},i=new Gibberish.KarplusStrong(t).connect(this);this.children.push(i)}Gibberish.polyInit(this),Gibberish._synth.oscillatorInit.call(this)},Gibberish.bus=function(){this.type="bus",this.inputCodegen=function(){var e=this.value.codegen(),t=1===this.amp?e:e+" * "+this.amp;return this.codeblock=t,t},this.addConnection=function(){var e={value:arguments[0],amp:arguments[1],codegen:this.inputCodegen};e.getCodeblock=e.value.getCodeblock.bind(e.value),this.inputs.push(e),Gibberish.dirty(this)},this.removeConnection=function(e){for(var t=0;this.inputs.length>t;t++)if(this.inputs[t].value===e){this.inputs.splice(t,1),Gibberish.dirty(this);break}},this.adjustSendAmount=function(e,t){for(var i=0;this.inputs.length>i;i++)if(this.inputs[i].value===e){this.inputs[i].amp=t,Gibberish.dirty(this);break}},this.callback=function(){var e=arguments[arguments.length-2],t=arguments[arguments.length-1];output[0]=output[1]=0;for(var i=0;arguments.length-2>i;i++){var r="object"==typeof arguments[i];output[0]+=r?arguments[i][0]:arguments[i],output[1]+=r?arguments[i][1]:arguments[i]}return output[0]*=e,output[1]*=e,panner(output,t,output)}},Gibberish.bus.prototype=new Gibberish.ugen,Gibberish._bus=new Gibberish.bus,Gibberish.Bus=function(){return Gibberish.extend(this,{name:"bus",properties:{inputs:[],amp:arguments[1]||1},callback:function(){for(var e=0,t=arguments.length-1,i=arguments[t],r=0;t>r;r++)e+=arguments[r];return e*=i}}),this.init(),this},Gibberish.Bus.prototype=Gibberish._bus,Gibberish.Bus2=function(){this.name="bus2",this.type="bus",this.properties={inputs:[],amp:arguments[1]||1,pan:0};var e=[0,0],t=Gibberish.makePanner();this.callback=function(){var i=arguments[arguments.length-2],r=arguments[arguments.length-1];e[0]=e[1]=0;for(var n=0;arguments.length-2>n;n++){var s="object"==typeof arguments[n];e[0]+=s?arguments[n][0]:arguments[n],e[1]+=s?arguments[n][1]:arguments[n]}return e[0]*=i,e[1]*=i,t(e,r,e)},this.initialized=!1,this.init()},Gibberish.Bus2.prototype=Gibberish._bus,Gibberish.envelope=function(){this.type="envelope"},Gibberish.envelope.prototype=new Gibberish.ugen,Gibberish._envelope=new Gibberish.envelope,Gibberish.ExponentialDecay=function(){var e=Math.pow,t=0,i=0;Gibberish.extend(this,{name:"ExponentialDecay",properties:{decay:.5,length:11050},callback:function(r,n){return t=e(r,i),i+=1/n,t},trigger:function(){i="number"==typeof arguments[0]?arguments[0]:0}}).init()},Gibberish.ExponentialDecay.prototype=Gibberish._envelope,Gibberish.Line=function(e,t,i,r){var n={name:"line",properties:{start:e||0,end:isNaN(t)?1:t,time:i||Gibberish.context.sampleRate,loops:r||!1}},s=0,a=(t-e)/i;return this.callback=function(e,t,i,r){var n=i>s?e+s++*a:t;return s=n>=t&&r?0:s,n},Gibberish.extend(this,n),this.init(),this},Gibberish.Line.prototype=Gibberish._envelope,Gibberish.AD=function(e,t){var i=0,r=0;Gibberish.extend(this,{name:"AD",properties:{attack:e||1e4,decay:t||1e4},run:function(){return r=0,i=0,this},callback:function(e,t){if(e=0>e?_4:e,t=0>t?_4:t,0===r){var n=1/e;i+=n,i>=1&&r++}else if(1===r){var n=1/t;i-=n,0>=i&&(i=0,r++)}return i},getState:function(){return r}}).init().processProperties(arguments)},Gibberish.AD.prototype=Gibberish._envelope,Gibberish.ADSR=function(e,t,i,r,n,s){var a={name:"adsr",type:"envelope",properties:{attack:isNaN(e)?1e4:e,decay:isNaN(t)?1e4:t,sustain:isNaN(i)?22050:i,release:isNaN(r)?1e4:r,attackLevel:n||1,sustainLevel:s||.5},run:function(){this.setPhase(0),this.setState(0)}};Gibberish.extend(this,a);var o=0,h=0;return this.callback=function(e,t,i,r,n,s){var a=0;return 0===h?(a=o/e*n,1===++o/e&&(h++,o=t)):1===h?(a=o/t*(n-s)+s,0>=--o&&(null!==i?(h+=1,o=i):(h+=2,o=r))):2===h?(a=s,0===o--&&(h++,o=r)):3===h&&(o--,a=o/r*s,0>=o&&h++),a},this.setPhase=function(e){o=e},this.setState=function(e){h=e,o=0},this.getState=function(){return h},this.init(),this},Gibberish.ADSR.prototype=Gibberish._envelope,Gibberish.ADR=function(e,t,i,r,n){var s={name:"adr",type:"envelope",properties:{attack:isNaN(e)?11025:e,decay:isNaN(t)?11025:t,release:isNaN(i)?22050:i,attackLevel:r||1,releaseLevel:n||.2},run:function(){this.setPhase(0),this.setState(0)}};Gibberish.extend(this,s);var a=0,o=0;return this.callback=function(e,t,i,r,n){var s=0;return 0===o?(s=a/e*r,1===++a/e&&(o++,a=t)):1===o?(s=a/t*(r-n)+n,0>=--a&&(o+=1,a=i)):2===o&&(a--,s=a/i*n,0>=a&&o++),s},this.setPhase=function(e){a=e},this.setState=function(e){o=e,a=0},this.getState=function(){return o},this.init(),this},Gibberish.ADR.prototype=Gibberish._envelope,Gibberish.analysis=function(){this.type="analysis",this.codegen=function(){return Gibberish.memo[this.symbol]?Gibberish.memo[this.symbol]:(v=this.variable?this.variable:Gibberish.generateSymbol("v"),Gibberish.memo[this.symbol]=v,this.variable=v,Gibberish.upvalues.push("var "+this.symbol+" = Gibberish.functions."+this.symbol+";\n"),this.codeblock="var "+this.variable+" = "+this.symbol+"();\n",this.variable)},this.codegen2=function(){for(var e in this.properties){var t=this.properties[e];if(Array.isArray(t.value))for(var i=0;t.value.length>i;i++){var r=t.value[i];"object"==typeof r&&(r.type="ddd",r.codegen(),r.getCodeblock(),r.type="analysis")}else if("object"==typeof t.value&&!Gibberish.memo[t.value.symbol]){t.value.type="ddd",t.value.codegen(),t.value.getCodeblock(),Gibberish.codeblock.push(t.value.codeblock),t.value.type="analysis";var n=t.value.variable?t.value.variable:Gibberish.generateSymbol("v");Gibberish.memo[t.value.symbol]=n,t.value.variable=n,Gibberish.codestring="var "+t.value.symbol+" = Gibberish.functions."+t.value.symbol+";\n"+Gibberish.codestring}if(t.binops)for(var s=0;t.binops.length>s;s++){var a=t.binops[s];"object"==typeof a.ugen&&a.ugen.codegen()}}},this.analysisCodegen=function(){var e=this.analysisSymbol+"("+this.input.variable+",";for(var t in this.properties)"input"!==t&&(e+=this[t]+",");return e=e.slice(0,-1),e+=");",this.analysisCodeblock=e,e},this.analysisInit=function(){this.analysisSymbol=Gibberish.generateSymbol(this.name),Gibberish.functions[this.analysisSymbol]=this.analysisCallback,Gibberish.upvalues.push("var "+this.analysisSymbol+" = Gibberish.functions."+this.analysisSymbol+";\n"),Gibberish.analysisUgens.push(this)}},Gibberish.analysis.prototype=new Gibberish.ugen,Gibberish._analysis=new Gibberish.analysis,Gibberish.Follow=function(){this.name="follow",this.properties={mult:1,input:0,bufferSize:4410};var e=Math.abs,t=[0],i=0,r=0,n=0;this.analysisCallback=function(s,a,o){i+=e(s),i-=t[r],t[r]=e(s),r=(r+1)%a,t[r]=t[r]?t[r]:0,n=i/a*o},this.callback=function(){return n},this.init()},Gibberish.Follow.prototype=Gibberish._analysis,Gibberish.SingleSampleDelay=function(){this.name="single_sample_delay",this.properties={input:arguments[0]||0,amp:arguments[1]||1};var e=0;this.analysisCallback=function(t,i){e="object"==typeof t?"object"==typeof t?[t[0]*i,t[1]*i]:t*i:t*i},this.callback=function(){return e},this.init(),this.analysisInit()},Gibberish.SingleSampleDelay.prototype=Gibberish._analysis,Gibberish.Record=function(e,t,i){var r=new Float32Array(t),n=0,s=!1,a=this;Gibberish.extend(this,{name:"record",oncomplete:i,properties:{input:0,size:t||0},analysisCallback:function(e,t){s&&(r[n++]="object"==typeof e?e[0]+e[1]:e,n>=t&&(s=!1,a.remove()))},record:function(){return n=0,s=!0,this},getBuffer:function(){return r},getPhase:function(){return n},remove:function(){this.oncomplete!==void 0&&this.oncomplete();for(var e=0;Gibberish.analysisUgens.length>e;e++){var t=Gibberish.analysisUgens[e];if(t===this)return Gibberish.analysisUgens.splice(e,1),void 0}}}),this.properties.input=e,this.init(),this.analysisInit(),Gibberish.dirty()},Gibberish.Record.prototype=Gibberish._analysis,Gibberish.effect=function(){this.type="effect"},Gibberish.effect.prototype=new Gibberish.ugen,Gibberish._effect=new Gibberish.effect,Gibberish.Distortion=function(){var e=Math.abs,t=Math.log,i=Math.LN2;Gibberish.extend(this,{name:"distortion",properties:{input:0,amount:50},callback:function(r,n){var s;return n=n>2?n:2,"number"==typeof r?(s=r*n,r=s/(1+e(s))/(t(n)/i)):(s=r[0]*n,r[0]=s/(1+e(s))/(t(n)/i),s=r[1]*n,r[1]=s/(1+e(s))/(t(n)/i)),r}}).init().processProperties(arguments)},Gibberish.Distortion.prototype=Gibberish._effect,Gibberish.Delay=function(){var e=[],t=0;e.push(new Float32Array(88200)),e.push(new Float32Array(88200)),Gibberish.extend(this,{name:"delay",properties:{input:0,time:22050,feedback:.5},callback:function(i,r,n){var s="number"==typeof i?1:2,a=t++%88200,o=(a+r)%88200;return 1===s?(e[0][o]=(i+e[0][a])*n,i+=e[0][a]):(e[0][o]=(i[0]+e[0][a])*n,i[0]+=e[0][a],e[1][o]=(i[1]+e[1][a])*n,i[1]+=e[1][a]),i}}).init().processProperties(arguments)},Gibberish.Delay.prototype=Gibberish._effect,Gibberish.Decimator=function(){var e=0,t=[],i=Math.pow,r=Math.floor;Gibberish.extend(this,{name:"decimator",properties:{input:0,bitDepth:16,sampleRate:1},callback:function(n,s,a){e+=a;var o="number"==typeof n?1:2;if(1===o){if(e>=1){var h=i(s,2);t[0]=r(n*h)/h,e-=1}n=t[0]}else{if(e>=1){var h=i(s,2);t[0]=r(n[0]*h)/h,t[1]=r(n[1]*h)/h,e-=1}n=t}return n}}).init().processProperties(arguments)},Gibberish.Decimator.prototype=Gibberish._effect,Gibberish.RingModulation=function(){var e=(new Gibberish.Sine).callback,t=[0,0];Gibberish.extend(this,{name:"ringmod",properties:{input:0,frequency:440,amp:.5,mix:.5},callback:function(i,r,n,s){var a="number"==typeof i?1:2,o=1===a?i:i[0],h=e(r,n);if(o=o*(1-s)+o*h*s,2===a){var b=i[1];return b=b*(1-s)+b*h*s,t[0]=o,t[1]=b,t}return o}}).init().processProperties(arguments)},Gibberish.RingModulation.prototype=Gibberish._effect,Gibberish.OnePole=function(){var e=0;Gibberish.extend(this,{name:"onepole",type:"effect",properties:{input:null,a0:.15,b1:.85},callback:function(t,i,r){var n=t*i+e*r;return e=n,n},smooth:function(e,t){this.input=t.properties[e],t.mod(e,this,"=")}}).init().processProperties(arguments)},Gibberish.OnePole.prototype=Gibberish._effect,Gibberish.Filter24=function(){var e=[0,0,0,0],t=[0,0,0,0],i=[0,0],r=isNaN(arguments[0])?.1:arguments[0],n=isNaN(arguments[1])?3:arguments[1];_isLowPass=arguments[2]!==void 0?arguments[2]:!0,Gibberish.extend(this,{name:"filter24",properties:{input:0,cutoff:r,resonance:n,isLowPass:_isLowPass},callback:function(r,n,s,a){var o="number"==typeof r?1:2,h=1===o?r:r[0],b=e[3]*s;if(b=b>1?1:b,n=0>n?0:n,n=n>1?1:n,h-=b,e[0]=e[0]+(-e[0]+h)*n,e[1]=e[1]+(-e[1]+e[0])*n,e[2]=e[2]+(-e[2]+e[1])*n,e[3]=e[3]+(-e[3]+e[2])*n,h=a?e[3]:h-e[3],2===o){var u=r[1];return b=t[3]*s,b=b>1?1:b,u-=b,t[0]=t[0]+(-t[0]+u)*n,t[1]=t[1]+(-t[1]+t[0])*n,t[2]=t[2]+(-t[2]+t[1])*n,t[3]=t[3]+(-t[3]+t[2])*n,u=a?t[3]:u-t[3],i[0]=h,i[1]=h,i}return h}}).init().processProperties(arguments)},Gibberish.Filter24.prototype=Gibberish._effect,Gibberish.SVF=function(){var e=[0,0],t=[0,0],i=Math.PI,r=[0,0];Gibberish.extend(this,{name:"SVF",properties:{input:0,cutoff:440,Q:2,mode:0,sr:Gibberish.context.sampleRate},callback:function(n,s,a,o,h){var b="number"==typeof n?1:2,u=1===b?n:n[0],c=2*i*s/h;a=1/a;var l=t[0]+c*e[0],p=u-l-a*e[0],f=c*p+e[0],d=p+l;if(e[0]=f,t[0]=l,u=0===o?l:1===o?p:2===o?f:d,2===b){var m=n[1],l=t[1]+c*e[1],p=m-l-a*e[1],f=c*p+e[1],d=p+l;e[1]=f,t[1]=l,m=0===o?l:1===o?p:2===o?f:d,r[0]=u,r[1]=m}else r=u;return r}}).init().processProperties(arguments)},Gibberish.SVF.prototype=Gibberish._effect,Gibberish.Biquad=function(){var e=x2=y1=y2=0,t=[0,0],i=.001639,r=.003278,n=.001639,s=-1.955777,a=.960601,o="LP",h=2e3,b=.5,u=Gibberish.context.sampleRate;Gibberish.extend(this,{name:"biquad",properties:{input:null},calculateCoefficients:function(){switch(o){case"LP":var e=2*Math.PI*h/u,t=Math.sin(e),c=Math.cos(e),l=t/(2*b);i=(1-c)/2,r=1-c,n=i,a0=1+l,s=-2*c,a=1-l;break;case"HP":var e=2*Math.PI*h/u,t=Math.sin(e),c=Math.cos(e),l=t/(2*b);i=(1+c)/2,r=-(1+c),n=i,a0=1+l,s=-2*c,a=1-l;break;case"BP":var e=2*Math.PI*h/u,t=Math.sin(e),c=Math.cos(e),p=Math.log(2)/2*b*e/t,l=t*(Math.exp(p)-Math.exp(-p))/2;i=l,r=0,n=-l,a0=1+l,s=-2*c,a=1-l;break;default:return}i/=a0,r/=a0,n/=a0,s/=a0,a/=a0},callback:function(o){var h="number"==typeof o?1:2,b=0,u=0,c=1===h?o:o[0];return b=i*c+r*e+n*x2-s*y1-a*y2,x2=e,e=o,y2=y1,y1=b,2===h&&(inR=o[1],u=i*inR+r*e[1]+n*x2[1]-s*y1[1]-a*y2[1],x2[1]=e[1],e[1]=o[1],y2[1]=y1[1],y1[1]=u,t[0]=b,t[1]=u),1===h?b:t}}).init(),Object.defineProperties(this,{mode:{get:function(){return o},set:function(e){o=e,this.calculateCoefficients()}},cutoff:{get:function(){return h},set:function(e){h=e,this.calculateCoefficients()}},Q:{get:function(){return b},set:function(e){b=e,this.calculateCoefficients()}}}),this.processProperties(arguments),this.calculateCoefficients()},Gibberish.Biquad.prototype=Gibberish._effect,Gibberish.Flanger=function(){var e=[new Float32Array(88200),new Float32Array(88200)],t=88200,i=(new Gibberish.Sine).callback,r=Gibberish.interpolate,n=-100,s=0;Gibberish.extend(this,{name:"flanger",properties:{input:0,rate:.25,amount:125,feedback:0,offset:125},callback:function(a,o,h,b,u,c){var c="number"==typeof a?1:2,l=n+i(o,.95*h);l>t?l-=t:0>l&&(l+=t);var p=r(e[0],l);return e[0][s]=1===c?a+p*b:a[0]+p*b,2===c?(a[0]+=p,p=r(e[1],l),e[1][s]=a[1]+p*b,a[1]+=p):a+=p,++s>=t&&(s=0),++n>=t&&(n=0),a
}}).init().processProperties(arguments),n=-1*this.offset},Gibberish.Flanger.prototype=Gibberish._effect,Gibberish.Vibrato=function(){var e=[new Float32Array(88200),new Float32Array(88200)],t=88200,i=(new Gibberish.Sine).callback,r=Gibberish.interpolate,n=-100,s=0;Gibberish.extend(this,{name:"vibrato",properties:{input:0,rate:5,amount:.5,offset:125},callback:function(a,o,h,b){var u="number"==typeof a?1:2,c=n+i(o,h*b-1);c>t?c-=t:0>c&&(c+=t);var l=r(e[0],c);return e[0][s]=1===u?a:a[0],2===u?(a[0]=l,l=r(e[1],c),e[1][s]=a[1],a[1]=l):a=l,++s>=t&&(s=0),++n>=t&&(n=0),a}}).init().processProperties(arguments),n=-1*this.offset},Gibberish.Vibrato.prototype=Gibberish._effect,Gibberish.BufferShuffler=function(){var e=[new Float32Array(88200),new Float32Array(88200)],t=88200,i=0,r=0,n=0,s=0,a=0,o=Math.random,h=1,b=!1,u=!1,c=!1,l=Gibberish.interpolate,p=!1,f=1,d=!1,m=Gibberish.rndf,y=[0,0];Gibberish.extend(this,{name:"buffer_shuffler",properties:{input:0,chance:.25,rate:11025,length:22050,reverseChange:.5,pitchChance:.5,pitchMin:.25,pitchMax:2,wet:1,dry:0},callback:function(v,g,G,k,_,w,x,P,S,A){var M="number"==typeof v?1:2;a?0===++s%(k-400)&&(b=!1,u=!0,h=1,s=0):(e[0][r]=1===M?v:v[0],e[1][r]=1===M?v:v[1],r++,r%=t,d=0===r?1:d,n++,0==n%G&&g>o()&&(c=_>o(),a=!0,c||(i=r-k,0>i&&(i=t+i)),p=w>o(),p&&(f=m(x,P)),h=1,b=!0,u=!1)),i+=c?-1*f:f,0>i?i+=t:i>=t&&(i-=t);var C,I,F,R,q=l(e[0],i);return b?(h-=.0025,F=q*(1-h),C=1===M?F+v*h:F+v[0]*h,2===M&&(R=l(e[1],i),F=R*(1-h),I=1===M?C:F+v[1]*h),.0025>=h&&(b=!1)):u?(h-=.0025,F=q*h,C=1===M?F+v*h:F+v[0]*(1-h),2===M&&(R=l(e[1],i),F=R*h,I=F+v[1]*(1-h)),.0025>=h&&(u=!1,a=!1,c=!1,f=1,p=0)):1===M?C=a&&d?q*S+v*A:v:(R=l(e[1],i),C=a&&d?q*S+v[0]*A:v[0],I=a&&d?R*S+v[1]*A:v[1]),y=[C,I],1===M?C:y}}).init().processProperties(arguments)},Gibberish.BufferShuffler.prototype=Gibberish._effect,Gibberish.AllPass=function(e){var t=-1,i=new Float32Array(e||500),r=i.length;Gibberish.extend(this,{name:"allpass",properties:{input:0},callback:function(e){t=++t%r;var n=i[t],s=-1*e+n;return i[t]=e+.5*n,s}})},Gibberish.Comb=function(e){var t=new Float32Array(e||1200),i=t.length,r=0,n=0;Gibberish.extend(this,{name:"comb",properties:{input:0,time:e||1200},callback:function(e){var s=++r%i,a=t[s];return n=.8*a+.2*n,t[s]=e+.84*n,a}})},Gibberish.Reverb=function(){var e={combCount:8,combTuning:[1116,1188,1277,1356,1422,1491,1557,1617],allPassCount:4,allPassTuning:[556,441,341,225],allPassFeedback:.5,fixedGain:.015,scaleDamping:.9,scaleRoom:.28,offsetRoom:.7,stereoSpread:23},t=[],i=[],r=[0,0];Gibberish.extend(this,{name:"reverb",roomSize:.5,damping:.2223,properties:{input:0,wet:.5,dry:.55},callback:function(e,n,s){for(var a="object"==typeof e?2:1,o=1===a?e:e[0]+e[1],h=.015*o,b=h,u=0;8>u;u++){var c=t[u](h);b+=c}for(var u=0;4>u;u++)b=i[u](b);return r[0]=r[1]=o*s+b*n,r}}).init().processProperties(arguments);for(var n=0;8>n;n++)t.push(new Gibberish.Comb(e.combTuning[n],this.roomSize*e.scaleRoom*e.offsetRoom,this.damping).callback);for(var n=0;4>n;n++)i.push(new Gibberish.AllPass(e.allPassTuning[n],e.allPassFeedback).callback)},Gibberish.Reverb.prototype=Gibberish._effect,Gibberish.Granulator=function(e){var t=[];buffer=null,interpolate=Gibberish.interpolate,panner=Gibberish.makePanner(),bufferLength=0,debug=0,write=0,self=this,out=[0,0],_out=[0,0],rndf=Gibberish.rndf,numberOfGrains=e.numberOfGrains||20,Gibberish.extend(this,{name:"granulator",bufferLength:88200,reverse:!0,spread:.5,properties:{speed:1,speedMin:0,speedMax:0,grainSize:1e3,position:.5,positionMin:0,positionMax:0,amp:.2,fade:.1,pan:0,shouldWrite:!1},callback:function(e,i,r,n,s,a,o,h,b,u){for(var c=0;numberOfGrains>c;c++){var l=t[c];if(l._speed>0){l.pos>l.end&&(l.pos=(o+rndf(s,a))*buffer.length,l.start=l.pos,l.end=l.start+n,l._speed=e+rndf(i,r),l._speed=.1>l._speed?.1:l._speed,l._speed=.1>l._speed&&l._speed>0?.1:l._speed,l._speed=l._speed>-.1&&0>l._speed?-.1:l._speed,l.fadeAmount=l._speed*b*n,l.pan=rndf(-1*self.spread,self.spread));for(var p=l.pos;p>buffer.length;)p-=buffer.length;for(;0>p;)p+=buffer.length;var f=interpolate(buffer,p);f*=l.pos<l.fadeAmount+l.start?(l.pos-l.start)/l.fadeAmount:1,f*=l.pos>l.end-l.fadeAmount?(l.end-l.pos)/l.fadeAmount:1}else{l.pos<l.end&&(l.pos=(o+rndf(s,a))*buffer.length,l.start=l.pos,l.end=l.start-n,l._speed=e+rndf(i,r),l._speed=.1>l._speed&&l._speed>0?.1:l._speed,l._speed=l._speed>-.1&&0>l._speed?-.1:l._speed,l.fadeAmount=l._speed*b*n);for(var p=l.pos;p>buffer.length;)p-=buffer.length;for(;0>p;)p+=buffer.length;var f=interpolate(buffer,p);f*=l.pos>l.start-l.fadeAmount?(l.start-l.pos)/l.fadeAmount:1,f*=l.pos<l.end+l.fadeAmount?(l.end-l.pos)/l.fadeAmount:1}_out=panner(f*h,l.pan,_out),out[0]+=_out[0],out[1]+=_out[1],l.pos+=l._speed}return panner(out,u,out)}}).init().processProperties(arguments);for(var i=0;numberOfGrains>i;i++)t[i]={pos:self.position+Gibberish.rndf(self.positionMin,self.positionMax),_speed:self.speed+Gibberish.rndf(self.speedMin,self.speedMax)},t[i].start=t[i].pos,t[i].end=t[i].pos+self.grainSize,t[i].fadeAmount=t[i]._speed*self.fade*self.grainSize,t[i].pan=Gibberish.rndf(-1*self.spread,self.spread);e.input!==void 0?(that.shouldWrite=!0,that.sampler=new Gibberish.Sampler,that.sampler.connect(),that.sampler.record(e.buffer,that.bufferLength),that.buffer=that.sampler.buffer):e.buffer!==void 0&&(buffer=e.buffer,bufferLength=buffer.length)},Gibberish.Granulator.prototype=Gibberish._effect,Gibberish.synth=function(){this.type="oscillator",this.oscillatorInit=function(){this.fx=new Array2,this.fx.parent=this}},Gibberish.synth.prototype=new Gibberish.ugen,Gibberish._synth=new Gibberish.synth,Gibberish.Synth=function(){this.name="synth",this.properties={frequency:0,pulsewidth:.5,attack:22050,decay:22050,glide:.15,amp:.25,channels:2,pan:0,sr:Gibberish.context.sampleRate},this.note=function(t,i){"object"!=typeof this.frequency?(this.frequency=t,_frequency=t):(this.frequency[0]=t,_frequency=t,Gibberish.dirty(this)),i!==void 0&&(this.amp=i),e.run()};var e=new Gibberish.AD,t=e.getState,i=e.callback,r=new Gibberish.PWM,n=r.callback,s=(new Gibberish.OnePole).callback,a=Gibberish.makePanner(),o=[0,0];this.callback=function(e,r,h,b,u,c,l,p,f){if(u=u>=1?.99999:u,e=s(e,1-u,u),2>t()){var d=i(h,b),m=n(e,1,r,f)*d*c;return o[0]=o[1]=m,1===l?m:a(m,p,o)}return m=o[0]=o[1]=0,1===l?m:a(m,p,o)},this.getOsc=function(){return r},this.setOsc=function(e){r=e,n=r.callback};var h="PWM";Object.defineProperty(this,"waveform",{get:function(){return h},set:function(e){this.setOsc(new Gibberish[e])}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Synth.prototype=Gibberish._synth,Gibberish.PolySynth=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polysynth",maxVoices:5,voiceCount:0,polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,pulsewidth:.5,waveform:"PWM"},note:function(e,t){var i=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),i.note(e,t)}}),this.amp=1/this.maxVoices,this.processProperties(arguments),this.children=[],this.dirty=!0;for(var e=0;this.maxVoices>e;e++){var t={attack:this.attack,decay:this.decay,pulsewidth:this.pulsewidth,channels:2,amp:1},i=new Gibberish.Synth(t);i.connect(this),this.children.push(i)}Gibberish.polyInit(this),Gibberish._synth.oscillatorInit.call(this)},Gibberish.Synth2=function(){this.name="synth2",this.properties={frequency:0,pulsewidth:.5,attack:22050,decay:22050,cutoff:.25,resonance:3.5,useLowPassFilter:!0,glide:.15,amp:.25,channels:1,pan:0},this.note=function(t,i){"object"!=typeof this.frequency?(this.frequency=t,_frequency=t):(this.frequency[0]=t,_frequency=t,Gibberish.dirty(this)),i!==void 0&&(this.amp=i),e.run()};var e=new Gibberish.AD,t=e.getState,i=e.callback,r=new Gibberish.PWM,n=r.callback,s=new Gibberish.Filter24,a=s.callback,o=(new Gibberish.OnePole).callback,h=Gibberish.makePanner(),b=[0,0];this.callback=function(e,r,s,u,c,l,p,f,d,m,y){if(2>t()){f=f>=1?.99999:f,e=o(e,1-f,f);var v=i(s,u),g=a(n(e,.15,r),c*v,l,p)*v*d;return b[0]=b[1]=g,1===m?g:h(g,y,b)}return g=b[0]=b[1]=0,1===m?g:h(g,y,b)},this.getOsc=function(){return r},this.setOsc=function(e){r=e,n=r.callback};var u="PWM";Object.defineProperty(this,"waveform",{get:function(){return u},set:function(e){this.setOsc(new Gibberish[e])}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Synth2.prototype=Gibberish._synth,Gibberish.PolySynth2=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polysynth2",maxVoices:5,voiceCount:0,polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,pulsewidth:.5,waveform:"PWM"},note:function(e,t){var i=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),i.note(e,t)}}),this.amp=1/this.maxVoices,this.processProperties(arguments),this.children=[],this.dirty=!0;for(var e=0;this.maxVoices>e;e++){var t={attack:this.attack,decay:this.decay,pulsewidth:this.pulsewidth,channels:2,amp:1},i=new Gibberish.Synth2(t);i.connect(this),this.children.push(i)}Gibberish.polyInit(this),Gibberish._synth.oscillatorInit.call(this)},Gibberish.FMSynth=function(){this.name="fmSynth",this.properties={frequency:0,cmRatio:2,index:5,attack:22050,decay:22050,glide:.15,amp:.25,channels:2,pan:0},this.note=function(t,i){"object"!=typeof this.frequency?(this.frequency=t,_frequency=t):(this.frequency[0]=t,_frequency=t,Gibberish.dirty(this)),i!==void 0&&(this.amp=i),e.run()};var e=new Gibberish.AD,t=e.getState,i=e.callback,r=(new Gibberish.Sine).callback,n=(new Gibberish.Sine).callback,s=(new Gibberish.OnePole).callback,a=Gibberish.makePanner(),o=[0,0];this.callback=function(e,h,b,u,c,l,p,f,d){if(2>t()){l>=1&&(l=.9999),e=s(e,1-l,l);var m=i(u,c),y=n(e*h,e*b)*m,v=r(e+y,1)*m*p;return o[0]=o[1]=v,1===f?v:a(v,d,o)}return v=o[0]=o[1]=0,1===f?v:a(v,d,o)},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.FMSynth.prototype=Gibberish._synth,Gibberish.PolyFM=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polyfm",maxVoices:5,voiceCount:0,children:[],polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,index:5,cmRatio:2},note:function(e,t){var i=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),i.note(e,t)}}),this.amp=1/this.maxVoices,this.processProperties(arguments);for(var e=0;this.maxVoices>e;e++){var t={attack:this.attack,decay:this.decay,cmRatio:this.cmRatio,index:this.index,channels:2,amp:1},i=new Gibberish.FMSynth(t);i.connect(this),this.children.push(i)}Gibberish.polyInit(this),Gibberish._synth.oscillatorInit.call(this)},AudioFileRequest.prototype.onSuccess=function(){},AudioFileRequest.prototype.onFailure=function(){},AudioFileRequest.prototype.send=function(){if("wav"!=this.extension&&"aiff"!=this.extension&&"aif"!=this.extension)return this.onFailure(),void 0;var e=new XMLHttpRequest;e.open("GET",this.url,this.async),e.overrideMimeType("text/plain; charset=x-user-defined"),e.onreadystatechange=function(){4==e.readyState&&(200==e.status||0==e.status?this.handleResponse(e.responseText):this.onFailure())}.bind(this),e.send(null)},AudioFileRequest.prototype.handleResponse=function(e){var t,i;"wav"==this.extension?(t=new WAVDecoder,i=t.decode(e)):("aiff"==this.extension||"aif"==this.extension)&&(t=new AIFFDecoder,i=t.decode(e)),this.onSuccess(i)},Decoder.prototype.readString=function(e,t,i){return e.slice(t,t+i)},Decoder.prototype.readIntL=function(e,t,i){for(var r=0,n=0;i>n;n++)r+=(255&e.charCodeAt(t+n))*Math.pow(2,8*n);return r},Decoder.prototype.readChunkHeaderL=function(e,t){var i={};return i.name=this.readString(e,t,4),i.length=this.readIntL(e,t+4,4),i},Decoder.prototype.readIntB=function(e,t,i){for(var r=0,n=0;i>n;n++)r+=(255&e.charCodeAt(t+n))*Math.pow(2,8*(i-n-1));return r},Decoder.prototype.readChunkHeaderB=function(e,t){var i={};return i.name=this.readString(e,t,4),i.length=this.readIntB(e,t+4,4),i},Decoder.prototype.readFloatB=function(e,t){var i=this.readIntB(e,t,2),r=32768;i>=r&&(i|=~(r-1));var n=1;0>i&&(n=-1,i+=r);var s,a=this.readIntB(e,t+2,4),o=this.readIntB(e,t+6,4);return 0==(i==a==o)?s=0:32767==i?s=Number.MAX_VALUE:(i-=16383,s=(4294967296*a+o)*Math.pow(2,i-63)),n*s},WAVDecoder.prototype.__proto__=Decoder.prototype,WAVDecoder.prototype.decode=function(e){var t={},i=0,r=this.readChunkHeaderL(e,i);if(i+=8,"RIFF"!=r.name)return console.error("File is not a WAV"),null;var n=r.length;n+=8;var s=this.readString(e,i,4);if(i+=4,"WAVE"!=s)return console.error("File is not a WAV"),null;for(;n>i;){var r=this.readChunkHeaderL(e,i);if(i+=8,"fmt "==r.name){var a=this.readIntL(e,i,2);if(i+=2,1!=a)return console.error("Cannot decode non-PCM encoded WAV file"),null;var o=this.readIntL(e,i,2);i+=2;var h=this.readIntL(e,i,4);i+=4,i+=4,i+=2;var b=this.readIntL(e,i,2),u=b/8;i+=2}else if("data"==r.name){for(var c=r.length/(u*o),l=[],p=0;o>p;p++)l.push(new Float32Array(c));for(var p=0;o>p;p++)for(var f=l[p],d=0;c>d;d++){var m=i;m+=(d*o+p)*u;var y=this.readIntL(e,m,u),v=1<<b-1;y>=v&&(y|=~(v-1)),f[d]=y/v}i+=r.length}else i+=r.length}return t.sampleRate=h,t.bitDepth=b,t.channels=l,t.length=c,t},AIFFDecoder.prototype.__proto__=Decoder.prototype,AIFFDecoder.prototype.decode=function(e){var t={},i=0,r=this.readChunkHeaderB(e,i);if(i+=8,"FORM"!=r.name)return console.error("File is not an AIFF"),null;var n=r.length;n+=8;var s=this.readString(e,i,4);if(i+=4,"AIFF"!=s)return console.error("File is not an AIFF"),null;for(;n>i;){var r=this.readChunkHeaderB(e,i);if(i+=8,"COMM"==r.name){var a=this.readIntB(e,i,2);i+=2;var o=this.readIntB(e,i,4);i+=4;for(var h=[],b=0;a>b;b++)h.push(new Float32Array(o));var u=this.readIntB(e,i,2),c=u/8;i+=2;var l=this.readFloatB(e,i);i+=10}else if("SSND"==r.name){var p=this.readIntB(e,i,4);i+=4,i+=4,i+=p;for(var b=0;a>b;b++)for(var f=h[b],d=0;o>d;d++){var m=i;m+=(d*a+b)*c;var y=this.readIntB(e,m,c),v=1<<u-1;y>=v&&(y|=~(v-1)),f[d]=y/v}i+=r.length-p-8}else i+=r.length}return t.sampleRate=l,t.bitDepth=u,t.channels=h,t.length=o,t},Gibberish.Sampler=function(){var e=1,t=Gibberish.interpolate,i=Gibberish.makePanner(),r=[0,0],n=null,s=1,a=this;if(Gibberish.extend(this,{name:"sampler",file:null,isLoaded:!1,playOnLoad:0,properties:{pitch:1,amp:1,isRecording:!1,isPlaying:!0,input:0,length:0,start:0,end:1,loops:0,pan:0},_onload:function(t){n=t.channels[0],s=t.length,a.end=s,a.length=e=s,a.isPlaying=!0,console.log("LOADED ",a.file,s),Gibberish.audioFiles[a.file]=n,a.onload&&a.onload(),0!==a.playOnLoad&&a.note(a.playOnLoad),a.isLoaded=!0},floatTo16BitPCM:function(e,t,i){for(var r=0;i.length-1>r;r++,t+=2){var n=Math.max(-1,Math.min(1,i[r]));e.setInt16(t,0>n?32768*n:32767*n,!0)}},encodeWAV:function(){function e(e,t,i){for(var r=0;i.length>r;r++)e.setUint8(t+r,i.charCodeAt(r))}var t=this.getBuffer(),i=new ArrayBuffer(44+2*t.length),r=new DataView(i),n=Gibberish.context.sampleRate;return e(r,0,"RIFF"),r.setUint32(4,32+2*t.length,!0),e(r,8,"WAVE"),e(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,1,!0),r.setUint32(24,n,!0),r.setUint32(28,4*n,!0),r.setUint16(32,2,!0),r.setUint16(34,16,!0),e(r,36,"data"),r.setUint32(40,2*t.length,!0),this.floatTo16BitPCM(r,44,t),r},download:function(){var e=this.encodeWAV(),t=new Blob([e]),i=window.webkitURL.createObjectURL(t),r=window.document.createElement("a");r.href=i,r.download="output.wav";var n=document.createEvent("Event");n.initEvent("click",!0,!0),r.dispatchEvent(n)},note:function(t,i){if("number"==typeof this.pitch?this.pitch=t:"object"==typeof this.pitch&&(this.pitch[0]=t,Gibberish.dirty(this)),"number"==typeof i&&(this.amp=i),null!==this.function){this.isPlaying=!0;var r="number"==typeof this.pitch?this.pitch:this.pitch[0];e=r>0?this.start:this.end}},record:function(t,i){this.isRecording=!0;var r=this;new Gibberish.Record(t,i,function(){n=this.getBuffer(),r.end=s=n.length,e=r.end,r.isRecording=!1}).record()},getBuffer:function(){return n},callback:function(s,a,o,h,b,u,c,l,p,f){var d=0;return e+=s,l>e&&e>0?(s>0?d=null!==n&&h?t(n,e):0:e>c?d=null!==n&&h?t(n,e):0:e=p?l:e,i(d,f,r)):(e=p&&s>0?c:e,e=p&&0>s?l:e,r[0]=r[1]=d,r)}}).init().oscillatorInit().processProperties(arguments),arguments[0]!==void 0&&("string"==typeof arguments[0]?(console.log("SETTING FILE"),this.file=arguments[0],this.pitch=0):"object"==typeof arguments[0]&&arguments[0].file&&(this.file=arguments[0].file)),Gibberish.audioFiles[this.file]!==void 0)n=Gibberish.audioFiles[this.file],this.end=this.bufferLength=n.length,e=this.bufferLength,Gibberish.dirty(this),this.onload&&this.onload();else if(null!==this.file){var o=new AudioFileRequest(this.file);o.onSuccess=this._onload,o.send()}else this.buffer!==void 0&&(this.isLoaded=!0,n=this.buffer,this.end=this.bufferLength=n.length,e=this.bufferLength,arguments[0]&&arguments[0].loops&&(this.loops=1),Gibberish.dirty(this),this.onload&&this.onload())},Gibberish.Sampler.prototype=Gibberish._oscillator,Gibberish.MonoSynth=function(){Gibberish.extend(this,{name:"monosynth",properties:{frequency:0,amp1:1,amp2:1,amp3:1,attack:1e4,decay:1e4,cutoff:.2,resonance:2.5,filterMult:.3,isLowPass:!0,amp:.6,detune2:.01,detune3:-.01,octave2:1,octave3:-1,glide:0,pan:0,channels:1},waveform:"Saw3",note:function(e,r){r!==void 0&&(this.amp=r),"object"!=typeof this.frequency?this.frequency=e:(this.frequency[0]=e,Gibberish.dirty(this)),i()>0&&t.run()}});var e=this.waveform;Object.defineProperty(this,"waveform",{get:function(){return e},set:function(t){e!==t&&(e=t,s=(new Gibberish[t]).callback,a=(new Gibberish[t]).callback,o=(new Gibberish[t]).callback)}});var t=new Gibberish.AD(this.attack,this.decay),i=t.getState,r=t.callback,n=(new Gibberish.Filter24).callback,s=new Gibberish[this.waveform](this.frequency,this.amp1).callback,a=new Gibberish[this.waveform](this.frequency2,this.amp2).callback,o=new Gibberish[this.waveform](this.frequency3,this.amp3).callback,h=(new Gibberish.OnePole).callback,b=Gibberish.makePanner(),u=[0,0];this.callback=function(e,t,c,l,p,f,d,m,y,v,g,G,k,_,w,x,P,S){if(2>i()){x>=1&&(x=.9999),e=h(e,1-x,x);var A=e;if(_>0)for(var M=0;_>M;M++)A*=2;else if(0>_)for(var M=0;M>_;M--)A/=2;var C=e;if(w>0)for(var M=0;w>M;M++)C*=2;else if(0>w)for(var M=0;M>w;M--)C/=2;A+=G>0?(2*e-e)*G:(e-e/2)*G,C+=k>0?(2*e-e)*k:(e-e/2)*k;var I=s(e,t,1)+a(A,c,1)+o(C,l,1),F=r(p,f),R=n(I,d+y*F,m,v,1)*F;return R*=g,u[0]=u[1]=R,1===S?u:b(R,P,u)}return u[0]=u[1]=0,u},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.MonoSynth.prototype=Gibberish._synth,Gibberish.Binops={"export":function(e){Gibberish.export("Binops",e||window)},operator:function(){var e=new Gibberish.ugen,t=arguments[0],i=Array.prototype.slice.call(arguments,1);e.name="op",e.properties={};for(var r=0;i.length>r;r++)e.properties[r]=i[r];return e.init.apply(e,i),e.codegen=function(){var e,i="( ";if(Gibberish.memo[this.symbol]!==void 0)return Gibberish.memo[this.symbol];e=Object.keys(this.properties);for(var r=0;e.length>r;r++){var n="object"==typeof this[r],s=!1;n?Gibberish.memo[this[r].symbol]?i+=Gibberish.memo[this[r].symbol]:(s=!0,i+=this[r].codegen()):i+=this[r],e.length-1>r&&(i+=" "+t+" ")}return i+=" )",this.codeblock="",Gibberish.memo[this.symbol]=i,i},e.processProperties.apply(e,i),e},Add:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("+"),Gibberish.Binops.operator.apply(null,e)},Sub:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("-"),Gibberish.Binops.operator.apply(null,e)},Mul:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("*"),Gibberish.Binops.operator.apply(null,e)},Div:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("/"),Gibberish.Binops.operator.apply(null,e)},Mod:function(){var e=Array.prototype.slice.call(arguments,0);return e.unshift("%"),Gibberish.Binops.operator.apply(null,e)},Abs:function(){Array.prototype.slice.call(arguments,0),Math.abs;var e={name:"abs",properties:{},callback:Math.abs};return e.__proto__=new Gibberish.ugen,e.properties[0]=arguments[0],e.init(),e},Sqrt:function(){Array.prototype.slice.call(arguments,0),_sqrt=Math.sqrt;var e={name:"sqrt",properties:{},callback:Math.sqrt};return e.__proto__=new Gibberish.ugen,e.properties[i]=arguments[0],e.init(),e},Pow:function(){var e=Array.prototype.slice.call(arguments,0),t={name:"pow",properties:{},callback:Math.pow};t.__proto__=new Gibberish.ugen;for(var i=0;e.length>i;i++)t.properties[i]=e[i];return t.init(),t},Merge:function(){var e=Array.prototype.slice.call(arguments,0),t={name:"merge",properties:{},callback:function(e){return e[0]+e[1]}};t.__proto__=new Gibberish.ugen;for(var i=0;e.length>i;i++)t.properties[i]=e[i];return t.init(),t}},Gibberish.Time={bpm:120,"export":function(e){Gibberish.export("Time",e||window)},ms:function(e){return Math.round(e*Gibberish.context.sampleRate/1e3)},seconds:function(e){return Math.round(e*Gibberish.context.sampleRate)},beats:function(e){return function(){var t=Gibberish.context.sampleRate/(Gibberish.Time.bpm/60);return Math.round(t*e)}}},Gibberish.Sequencer=function(){Gibberish.extend(this,{target:null,key:null,values:null,valuesIndex:0,durations:null,durationsIndex:0,nextTime:0,phase:0,isRunning:!1,playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!0,keysAndValues:null,counts:{},tick:function(){if(this.isRunning){if(this.phase===this.nextTime){if(null!==this.values){if(this.target){var e=this.values[this.valuesIndex++];"function"==typeof e&&(e=e()),"function"==typeof this.target[this.key]?this.target[this.key](e):this.target[this.key]=e}else"function"==typeof this.values[this.valuesIndex]&&this.values[this.valuesIndex++]();this.valuesIndex>=this.values.length&&(this.valuesIndex=0)}else if(null!==this.keysAndValues)for(var t in this.keysAndValues){var i=this.counts[t]++,e=this.keysAndValues[t][i];"function"==typeof e&&(e=e()),"function"==typeof this.target[t]?this.target[t](e):this.target[t]=e,this.counts[t]>=this.keysAndValues[t].length&&(this.counts[t]=0)}else"function"==typeof this.target[this.key]&&this.target[this.key]();if(this.phase=0,Array.isArray(this.durations)){var r=this.durations[this.durationsIndex++];this.nextTime="function"==typeof r?r():r,this.durationsIndex>=this.durations.length&&(this.durationsIndex=0)}else{var r=this.durations;this.nextTime="function"==typeof r?r():r}return this.repeatTarget&&(this.repeatCount++,this.repeatCount===this.repeatTarget&&(this.isRunning=!1,this.repeatCount=0)),void 0}this.phase++}},start:function(e){return e||(this.phase=0),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this},repeat:function(e){return this.repeatTarget=e,this},disconnect:function(){var e=Gibberish.sequencers.indexOf(this);Gibberish.sequencers.splice(e,1),this.isConnected=!1},connect:function(){-1===Gibberish.sequencers.indexOf(this)&&Gibberish.sequencers.push(this)}});for(var e in arguments[0])this[e]=arguments[0][e];for(var e in this.keysAndValues)this.counts[e]=0;this.connect()};var _hasInput=!1;Gibberish.Input=function(){var e=[];_hasInput||createInput(),this.type=this.name="input",this.fx=new Array2,this.fx.parent=this,this.properties={input:"input",amp:.5,channels:1},this.callback=function(t,i,r){return 1===r?e=t*i:(e[0]=t[0]*i,e[1]=t[1]*i),e},this.init(arguments),this.processProperties(arguments)},Gibberish.Input.prototype=new Gibberish.ugen,Gibberish.Kick=function(){var e=!1,t=(new Gibberish.SVF).callback,i=(new Gibberish.SVF).callback,r=.2,n=.8;Gibberish.extend(this,{name:"kick",properties:{pitch:50,__decay:20,__tone:1e3,amp:2,sr:Gibberish.context.sampleRate},callback:function(r,n,s,a,o){var h=e?60:0;return h=t(h,r,n,2,o),h=i(h,s,.5,0,o),h*=a,e=!1,h},note:function(t,i,r,n){"number"==typeof t&&(this.pitch=t),"number"==typeof i&&(this.decay=i),"number"==typeof r&&(this.tone=r),"number"==typeof n&&(this.amp=n),e=!0}}).init().oscillatorInit(),Object.defineProperties(this,{decay:{get:function(){return r},set:function(e){r=e>1?1:e,this.__decay=100*r}},tone:{get:function(){return n},set:function(e){n=e>1?1:e,this.__tone=220+1400*e}}}),this.processProperties(arguments)},Gibberish.Kick.prototype=Gibberish._oscillator,Gibberish.Conga=function(){var e=!1,t=(new Gibberish.SVF).callback;Gibberish.extend(this,{name:"conga",properties:{pitch:190,amp:2,sr:Gibberish.context.sampleRate},callback:function(i,r,n){var s=e?60:0;return s=t(s,i,50,2,n),s*=r,e=!1,s},note:function(t,i){"number"==typeof t&&(this.pitch=t),"number"==typeof i&&(this.amp=i),e=!0}}).init().oscillatorInit(),this.processProperties(arguments)},Gibberish.Conga.prototype=Gibberish._oscillator,Gibberish.Clave=function(){var e=!1,t=new Gibberish.SVF,i=t.callback;Gibberish.extend(this,{name:"clave",properties:{pitch:2500,amp:1,sr:Gibberish.context.sampleRate},callback:function(t,r,n){var s=e?2:0;return s=i(s,t,5,2,n),s*=r,e=!1,s},note:function(t,i){"number"==typeof t&&(this.pitch=t),"number"==typeof i&&(this.amp=i),e=!0}}).init().oscillatorInit(),this.bpf=t,this.processProperties(arguments)},Gibberish.Clave.prototype=Gibberish._oscillator,Gibberish.Tom=function(){var e=!1,t=(new Gibberish.SVF).callback,i=(new Gibberish.SVF).callback,r=new Gibberish.ExponentialDecay,n=r.callback,s=Math.random;Gibberish.extend(this,{name:"tom",properties:{pitch:80,amp:.5,sr:Gibberish.context.sampleRate},callback:function(r,a,o){var h,b=e?60:0;return b=t(b,r,30,2,o),h=16*s()-8,h=h>0?h:0,h*=n(.05,11025),h=i(h,120,.5,0,o),b+=h,b*=a,e=!1,b},note:function(t,i){"number"==typeof t&&(this.pitch=t),"number"==typeof i&&(this.amp=i),r.trigger(),e=!0}}).init().oscillatorInit(),r.trigger(1),this.processProperties(arguments)},Gibberish.Tom.prototype=Gibberish._oscillator,Gibberish.Cowbell=function(){var e=new Gibberish.Square,t=new Gibberish.Square,i=e.callback,r=t.callback,n=new Gibberish.SVF({mode:2}),s=n.callback,a=new Gibberish.ExponentialDecay(.0025,10500),o=a.callback;Gibberish.extend(this,{name:"cowbell",properties:{amp:1,pitch:560,bpfFreq:1e3,bpfRez:3,decay:22050,decayCoeff:1e-4,sr:Gibberish.context.sampleRate},callback:function(e,t,n,a,h,b,u){var c;return c=i(t,1,1,0),c+=r(845,1,1,0),c=s(c,n,a,2,u),c*=o(b,h),c*=e},note:function(e){a.trigger(),e&&(this.decay=e)}}).init().oscillatorInit().processProperties(arguments),this.bpf=n,this.eg=a,a.trigger(1)},Gibberish.Cowbell.prototype=Gibberish._oscillator,Gibberish.Snare=function(){var e=(new Gibberish.SVF).callback,t=(new Gibberish.SVF).callback,i=(new Gibberish.SVF).callback,r=new Gibberish.ExponentialDecay(.0025,11025),n=r.callback,s=Math.random,a=0;Gibberish.extend(this,{name:"snare",properties:{cutoff:1e3,decay:11025,tune:0,snappy:.5,amp:1,sr:Gibberish.context.sampleRate},callback:function(r,o,h,b,u,c){var l,p,f=0,d=0;return f=n(.0025,o),f>.005&&(d=(2*s()-1)*f,d=i(d,r+1e3*h,.5,1,c),d*=b,d=d>0?d:0,a=f,l=e(a,180*(h+1),15,2,c),p=t(a,330*(h+1),15,2,c),d+=l,d+=.8*p,d*=u),d},note:function(e,t,i,n){"number"==typeof e&&(this.tune=e),"number"==typeof n&&(this.cutoff=n),"number"==typeof i&&(this.snappy=i),"number"==typeof t&&(this.amp=t),r.trigger()}}).init().oscillatorInit().processProperties(arguments),r.trigger(1)},Gibberish.Snare.prototype=Gibberish._oscillator,Gibberish.Hat=function(){var e=new Gibberish.Square,t=new Gibberish.Square,i=new Gibberish.Square,r=new Gibberish.Square,n=new Gibberish.Square,s=new Gibberish.Square,a=e.callback,o=t.callback,h=i.callback,b=r.callback,u=n.callback,c=s.callback,l=new Gibberish.SVF({mode:2}),p=l.callback,f=new Gibberish.Filter24,d=f.callback,m=new Gibberish.ExponentialDecay(.0025,10500),y=m.callback,v=new Gibberish.ExponentialDecay(.1,7500);v.callback,Gibberish.extend(this,{name:"hat",properties:{amp:1,pitch:325,bpfFreq:7e3,bpfRez:2,hpfFreq:.975,hpfRez:0,decay:3500,decay2:3e3,sr:Gibberish.context.sampleRate},callback:function(e,t,i,r,n,s,l,f,m){var v;return v=a(t,1,.5,0),v+=o(1.4471*t,.75,1,0),v+=h(1.617*t,1,1,0),v+=b(1.9265*t,1,1,0),v+=u(2.5028*t,1,1,0),v+=c(2.6637*t,.75,1,0),v=p(v,i,r,2,m),v*=y(.001,l),v=d(v,n,s,0,1),v*=e},note:function(e,t){m.trigger(),v.trigger(),e&&(this.decay=e),t&&(this.decay2=t)}}).init().oscillatorInit().processProperties(arguments),this.bpf=l,this.hpf=f,m.trigger(1),v.trigger(1)},Gibberish.Hat.prototype=Gibberish._oscillator;